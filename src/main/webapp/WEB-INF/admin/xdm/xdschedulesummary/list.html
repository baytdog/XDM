<style>
	.webuploader-pick{
		padding: 0px 15px;
		height: 33px;
		line-height: 33px;
	}
	.table{
		table-layout: fixed;
	}

	/*.fixed-table-header{
		height:70px;
	}*/
</style>
<div id="page-content">
	<div class="col-sm-12 eq-box-sm">
		<div class="panel">
			<div class="panel panel-search">
				<div class="panel-body">
					<div class="form-inline">

						<div class="form-group">
							<select class="selectpicker form-control"  id="dept"  >
								<option value="">------请选择部门------</option>
								<option value="1">人力资源部</option>
								<option value="2">外场单元部</option>
								<option value="3">设施一部</option>
								<option value="4">内场单元部</option>
								<option value="5">工程/设施二部</option>
								<option value="887163179b6c4eaabd06c44e47e41f92">职能部门</option>
							</select>
						</div>
						<div class="form-group">
							<select class="selectpicker form-control"  id="unitname"  data-live-search="true" >
								<option value="">------请选择单元------</option>
								#for(unit:units)
								<option value="#(unit.value)">#(unit.name)</option>
								#end
							</select>
						</div>
						<div class="form-group">
							<input id="emp_name" placeholder="姓名" class="form-control">
						</div>
						<div class="form-group">
							<select class="selectpicker form-control"  id="year"  >
								<option value="">------请选择年份------</option>
								<option value="2023">2023年</option>
								<option value="2024">2024年</option>
								<option value="2025">2025年</option>
								<option value="2026">2026年</option>
								<option value="2027">2027年</option>
								<option value="2028">2028年</option>
							</select>
						</div>
						<div class="form-group">
							<select class="selectpicker form-control"  id="month"  >
								<option value="">------请选择月份------</option>
								<option value="01">1月</option>
								<option value="02">2月</option>
								<option value="03">3月</option>
								<option value="04">4月</option>
								<option value="05">5月</option>
								<option value="06">6月</option>
								<option value="07">7月</option>
								<option value="08">8月</option>
								<option value="09">9月</option>
								<option value="10">10月</option>
								<option value="11">11月</option>
								<option value="12">12月</option>
							</select>
						</div>

					<!--	<a href="#" id="username">用户名</a>-->
						<div class="form-group">
							<button class="btn btn-primary" type="button" onclick="searchTable()">搜索</button>
						</div>
					</div>
				</div>
			</div>
			<div class="panel ">
				<div class="panel-body table-responsive">
	<!--				<a id="add" class="btn btn-primary data-toolbar" href="#(ctx)/admin/xd/xdschedulesummary/getEditPage?view=edit"><i class="demo-pli-add"></i> 添加</a>-->
					<a id="del" class="btn btn-danger data-toolbar" onclick="delSel()" href="javascript:void(0);"><i class="demo-pli-cross"></i> 批量删除</a>
					<a id="filePicker"  href="javascript:void(0);" ><i class="demo-pli-add"></i> 导入</a>
					<a id="export" class="btn btn-primary data-toolbar" onclick="exportExcel()" target="_blank"><i class="demo-pli-download-from-cloud"></i> 导出</a>

					<table id="pageTable" class="demo-add-niftycheck table"
						   data-toolbar="#del,#add,#filePicker,#export"
						   data-width="90px"
						    ></table>
				</div>
			</div>
		</div>
	</div>
</div>
<script>

	function createTable(daysNum,weekLists,holidayLists){

		let firstRow=[
			{field: 'checked', checkbox : true,valign:'middle',halign:"center", align: 'center',rowspan: 3 },
			{field: 'dept_name', title: '部门',align: 'center',width:'120',valign:'middle',halign:"center",rowspan: 3 },
			{field: 'unit_name', title: '单元', align: 'center',width:'120',valign:'middle',halign:"center", colspan: 1,rowspan: 3 },
			{field: 'project_name', title: '项目', align: 'center',width:'120',valign:'middle',halign:"center", colspan: 1,rowspan: 3 },
			{field: 'emp_num', title: '工号', align: 'center',width:'80',valign:'middle',halign:"center", colspan: 1,rowspan: 3 },
			{field: 'emp_name', title: '姓名', align: 'center',width:'80',valign:'middle',halign:"center", colspan: 1,rowspan: 3 },
			{field: 'work_station', title: '岗位', align: 'center',width:'120',valign:'middle',halign:"center", colspan: 1,rowspan: 3 },
			{field: 'remarks', title: '备注', align: 'center',width:'150',valign:'middle',halign:"center", colspan: 1,rowspan: 3},
		];
		for (let i = 0; i <=daysNum; i++) {
			if(i<10){
				suffix='0'+i;
			}else{
				suffix=i;
			}
			firstRow.push({field: 'day0'+suffix, title: i, align: 'center',width:'80', colspan: 1,rowspan: 1})

		}
		firstRow.push({field: 'othours', title: '加班时长', align: 'center',width:'85',valign:'middle',halign:"center", colspan: 1,rowspan: 3},
				{field: 'cur_mon_hours', title: '当月工时', align: 'center',width:'85',valign:'middle',halign:"center", colspan: 1,rowspan: 3},
				{field: 'control', title: '操作', align: 'left', width:'60',valign:'middle',halign:"center",
					formatter:function(value,row,index){
						var	a = '<a class="label label-table label-danger" onclick="del(\''+row.id+'\')" href="javascript:void(0);" >删除</a>';
						return a;
					}, colspan: 1,rowspan: 3
				})
		col.push(firstRow)

		//console.log(holidayLists)

		var secondRrow=[
			/*{field: 'checked', checkbox : true, align: 'center' },
            {field: 'checked', checkbox : true, align: 'center' },
            {field: 'checked', checkbox : true, align: 'center' },
            {field: 'checked', checkbox : true, align: 'center' },
            {field: 'checked', checkbox : true, align: 'center' },
            {field: 'checked', checkbox : true, align: 'center' },*/
		];
		/*	let weekArr=weekLists.split(",");*/
		for (let i = 0; i < weekLists.length; i++) {
			let suffix="";
			if(i<10){
				suffix='0'+i;

			}else{
				suffix=i;
			}

			secondRrow.push({field: 'day'+suffix, title: weekLists[i], align: 'center',width:'80', colspan: 1,rowspan: 1})

		}

		var thirdRrow=[
			/*{field: 'checked', checkbox : true, align: 'center' },
            {field: 'checked', checkbox : true, align: 'center' },
            {field: 'checked', checkbox : true, align: 'center' },
            {field: 'checked', checkbox : true, align: 'center' },
            {field: 'checked', checkbox : true, align: 'center' },
            {field: 'checked', checkbox : true, align: 'center' },*/
		];


		for (let i = 0; i < holidayLists.length; i++) {
			let suffix="";
			if(i<10){
				suffix='0'+i;

			}else{
				suffix=i;
			}
			thirdRrow.push({field: 'day'+suffix, title: holidayLists[i], align: 'center',width:'80', colspan: 1,rowspan: 1,
				formatter:function(value,row,index){
				if(row.flags){
					let flagsArr = row.flags.split(",");

					if(flagsArr[parseInt(suffix)]=='1'){
						console.log("有调整")
						return "<span style='color:red'>"+value+"</span>";
					}else{
						return  value ;
					}
				}else{
					return  value ;
				}


				},cellStyle:function(value,row,index,field){                 // 修改列（单元格）的颜色
					let i = field.replace("day","");
				 inti=parseInt(i);
					if(holidayLists[inti].indexOf("-")!=-1){
						return {css:{}} ;
					}else{
						return {css:{"background-color":"yellow"}};
					}

				}})

		}
		col.push(secondRrow)
		col.push(thirdRrow)
	}
</script>
<script>
	let lastyear="#(year)";
	let lastmonth="#(month)";
	if(lastyear){
		$('#year').selectpicker('val',lastyear.split(",")).trigger("change");
	}
	if(lastmonth){
		$('#month').selectpicker('val',lastmonth.split(",")).trigger("change");
	}
	let weekLists="#(weekLists)";
	let holidayLists="#(holidayLists)";
	let daysNum="#(daysNum)";
	var col = [
		/*[{field: 'dept_name', title: '部门',align: 'center',width:'120',valign:'middle',halign:"center",rowspan: 3 },
		{field: 'unit_name', title: '单元', align: 'center',width:'120',valign:'middle',halign:"center", colspan: 1,rowspan: 3 },
		{field: 'project_name', title: '项目', align: 'center',width:'120',valign:'middle',halign:"center", colspan: 1,rowspan: 3 },
		{field: 'emp_num', title: '工号', align: 'center',width:'80',valign:'middle',halign:"center", colspan: 1,rowspan: 3 },
		{field: 'emp_name', title: '姓名', align: 'center',width:'80',valign:'middle',halign:"center", colspan: 1,rowspan: 3 },
		{field: 'work_station', title: '岗位', align: 'center',width:'120',valign:'middle',halign:"center", colspan: 1,rowspan: 3 },
		{field: 'day00', title: '上月', align: 'center',width:'80', colspan: 1,rowspan: 1},
		{field: 'day01', title: '1', align: 'center',width:'80', colspan: 1,rowspan: 1},
		{field: 'day02', title: '2', align: 'center',width:'80', colspan: 1,rowspan: 1},
		{field: 'day03', title: '3', align: 'center',width:'80', colspan: 1,rowspan: 1},
		{field: 'day04', title: '4', align: 'center',width:'80', colspan: 1,rowspan: 1},
		{field: 'day05', title: '5', align: 'center',width:'80', colspan: 1,rowspan: 1},
		{field: 'day06', title: '6', align: 'center',width:'80', colspan: 1,rowspan: 1},
		{field: 'day07', title: '7', align: 'center',width:'80', colspan: 1,rowspan: 1},
		{field: 'day08', title: '8', align: 'center',width:'80', colspan: 1,rowspan: 1},
		{field: 'day09', title: '9', align: 'center',width:'80', colspan: 1,rowspan: 1},
		{field: 'day10', title: '10', align: 'center',width:'80', colspan: 1,rowspan: 1},
		{field: 'day11', title: '11', align: 'center',width:'80', colspan: 1,rowspan: 1},
		{field: 'day12', title: '12', align: 'center',width:'80', colspan: 1,rowspan: 1},
		{field: 'day13', title: '13', align: 'center',width:'80', colspan: 1,rowspan: 1},
		{field: 'day14', title: '14', align: 'center',width:'80', colspan: 1,rowspan: 1},
		{field: 'day15', title: '15', align: 'center',width:'80', colspan: 1,rowspan: 1},
		{field: 'day16', title: '16', align: 'center',width:'80', colspan: 1,rowspan: 1},
		{field: 'day17', title: '17', align: 'center',width:'80', colspan: 1,rowspan: 1},
		{field: 'day18', title: '18', align: 'center',width:'80', colspan: 1,rowspan: 1},
		{field: 'day19', title: '19', align: 'center',width:'80', colspan: 1,rowspan: 1},
		{field: 'day20', title: '20', align: 'center',width:'80', colspan: 1,rowspan: 1},
		{field: 'day21', title: '21', align: 'center',width:'80', colspan: 1,rowspan: 1},
		{field: 'day22', title: '22', align: 'center',width:'80', colspan: 1,rowspan: 1},
		{field: 'day23', title: '23', align: 'center',width:'80', colspan: 1,rowspan: 1},
		{field: 'day24', title: '24', align: 'center',width:'80', colspan: 1,rowspan: 1},
		{field: 'day25', title: '25', align: 'center',width:'80', colspan: 1,rowspan: 1},
		{field: 'day26', title: '26', align: 'center',width:'80', colspan: 1,rowspan: 1},
		{field: 'day27', title: '27', align: 'center',width:'80', colspan: 1,rowspan: 1},
		{field: 'day28', title: '28', align: 'center',width:'80', colspan: 1,rowspan: 1},
		{field: 'day29', title: '29', align: 'center',width:'80', colspan: 1,rowspan: 1},
		{field: 'day30', title: '30', align: 'center',width:'80', colspan: 1,rowspan: 1},
		{field: 'day31', title: '31', align: 'center',width:'80', colspan: 1,rowspan: 1},

		{field: 'remarks', title: '备注', align: 'center',width:'150',valign:'middle',halign:"center", colspan: 1,rowspan: 3},
		{field: 'control', title: '操作', align: 'left', width:'60',valign:'middle',halign:"center",

			formatter:function(value,row,index){
				var	a = '<a class="label label-table label-danger" onclick="del(\''+row.id+'\')" href="javascript:void(0);" >删除</a>';
				return a;
			}, colspan: 1,rowspan: 3
		}]
				,*/



		/*[


			{field: 'day00', title: '上月', align: 'center',width:'80', colspan: 1,rowspan: 1},
			{field: 'day01', title: '1', align: 'center',width:'80',formatter:function(value,row,index){
						//通过formatter可以自定义列显示的内容
						//value：当前field的值，
						//row：当前行的数据
						if(value=='aa'){
							alert("111")
							return "<span style='color:blue'>"+value+"</span>";
						}else{
							return  value ;
						}

			}},
				{field: 'day02', title: '2', align: 'center',width:'80'},
				{field: 'day03', title: '3', align: 'center',width:'80'},
				{field: 'day04', title: '4', align: 'center',width:'80'},
				{field: 'day05', title: '5', align: 'center',width:'80'},
				{field: 'day06', title: '6', align: 'center',width:'80'},
				{field: 'day07', title: '7', align: 'center',width:'80'},
				{field: 'day08', title: '8', align: 'center',width:'80'},
				{field: 'day09', title: '9', align: 'center',width:'80'},
				{field: 'day10', title: '10', align: 'center',width:'80'},
				{field: 'day11', title: '11', align: 'center',width:'80'},
				{field: 'day12', title: '12', align: 'center',width:'80'},
				{field: 'day13', title: '13', align: 'center',width:'80'},
				{field: 'day14', title: '14', align: 'center',width:'80'},
				{field: 'day15', title: '15', align: 'center',width:'80'},
				{field: 'day16', title: '16', align: 'center',width:'80'},
				{field: 'day17', title: '17', align: 'center',width:'80'},
				{field: 'day18', title: '18', align: 'center',width:'80'},
				{field: 'day19', title: '19', align: 'center',width:'80'},
				{field: 'day20', title: '20', align: 'center',width:'80'},
				{field: 'day21', title: '21', align: 'center',width:'80'},
				{field: 'day22', title: '22', align: 'center',width:'80'},
				{field: 'day23', title: '23', align: 'center',width:'80'},
				{field: 'day24', title: '24', align: 'center',width:'80'},
				{field: 'day25', title: '25', align: 'center',width:'80'},
				{field: 'day26', title: '26', align: 'center',width:'80'},
				{field: 'day27', title: '27', align: 'center',width:'80'},
				{field: 'day28', title: '28', align: 'center',width:'80'},
				{field: 'day29', title: '29', align: 'center',width:'80'},
				{field: 'day30', title: '30', align: 'center',width:'80'},
				{field: 'day31', title: '31', align: 'center',width:'80'}


		 ],
		[
			{field: 'day01', title: '上月', align: 'center',width:'80', colspan: 1,rowspan: 1},
			{field: 'day01', title: '1', align: 'center',width:'80',formatter:function(value,row,index){
					//通过formatter可以自定义列显示的内容
					//value：当前field的值，
					//row：当前行的数据
					if(value=='aa'){
						alert("111")
						return "<span style='color:yellow'>"+value+"</span>";
					}else{
						return  value ;
					}

				},cellStyle:function(value,row,index){                 // 修改列（单元格）的颜色
					return {css:{"background-color":"yellow"}};
				}},
			{field: 'day02', title: '2', align: 'center',width:'80'},
			{field: 'day03', title: '3', align: 'center',width:'80'},
			{field: 'day04', title: '4', align: 'center',width:'80'},
			{field: 'day05', title: '5', align: 'center',width:'80'},
			{field: 'day06', title: '6', align: 'center',width:'80'},
			{field: 'day07', title: '7', align: 'center',width:'80'},
			{field: 'day08', title: '8', align: 'center',width:'80'},
			{field: 'day09', title: '9', align: 'center',width:'80'},
			{field: 'day10', title: '10', align: 'center',width:'80'},
			{field: 'day11', title: '11', align: 'center',width:'80'},
			{field: 'day12', title: '12', align: 'center',width:'80'},
			{field: 'day13', title: '13', align: 'center',width:'80'},
			{field: 'day14', title: '14', align: 'center',width:'80'},
			{field: 'day15', title: '15', align: 'center',width:'80'},
			{field: 'day16', title: '16', align: 'center',width:'80'},
			{field: 'day17', title: '17', align: 'center',width:'80'},
			{field: 'day18', title: '18', align: 'center',width:'80'},
			{field: 'day19', title: '19', align: 'center',width:'80'},
			{field: 'day20', title: '20', align: 'center',width:'80'},
			{field: 'day21', title: '21', align: 'center',width:'80'},
			{field: 'day22', title: '22', align: 'center',width:'80'},
			{field: 'day23', title: '23', align: 'center',width:'80'},
			{field: 'day24', title: '24', align: 'center',width:'80'},
			{field: 'day25', title: '25', align: 'center',width:'80'},
			{field: 'day26', title: '26', align: 'center',width:'80'},
			{field: 'day27', title: '27', align: 'center',width:'80'},
			{field: 'day28', title: '28', align: 'center',width:'80'},
			{field: 'day29', title: '29', align: 'center',width:'80'},
			{field: 'day30', title: '30', align: 'center',width:'80'},
			{field: 'day31', title: '31', align: 'center',width:'80'}


		]
*/		];
	weekLists=weekLists.replace("[","").replace("]","").split(",")
	holidayLists=holidayLists.replace("[","").replace("]","").split(",")
	createTable(daysNum,weekLists,holidayLists);

	var opt = {
	/*	height:$(document).height()-170,*/
		//请求方法
		method: 'get',
		//是否显示行间隔色
		striped: true,
		//是否使用缓存，默认为true，所以一般情况下需要设置一下这个属性（*）
		cache: false,
		//data-toolbar: "#demo-delete-row",
		//是否显示分页（*）
		pagination: true,
		//是否启用排序
		sortable: false,
		//排序方式
		sortOrder: "asc",
		//初始化加载第一页，默认第一页
		//我设置了这一项，但是貌似没起作用，而且我这默认是0,- -
		//pageNumber:1,
		//每页的记录行数（*）
		pageSize: 20,
		//可供选择的每页的行数（*）
		pageList: [100, 150, 200, 250],
		//这个接口需要处理bootstrap table传递的固定参数,并返回特定格式的json数据
		url: ctx+"/admin/xd/xdschedulesummary/listData",
		//默认值为 'limit',传给服务端的参数为：limit, offset, search, sort, order Else
		//queryParamsType:'',
		////查询参数,每次调用是会带上这个参数，可自定义
		queryParams : function(params) {
			return {
				pageNumber: (params.offset/params.limit)+1,
				pageSize: params.limit,
				"emp_name":encodeURIComponent($("#emp_name").val()),
				"dept":$("#dept").val(),
				"unitname":$("#unitname").val(),
				"year":$("#year").val(),
				"month":$("#month").val(),
			};
		},
		//分页方式：client客户端分页，server服务端分页（*）
		sidePagination: "server",
		//是否显示搜索
		search: false,
		//Enable the strict search.
		strictSearch: true,
		//Indicate which field is an identity field.
		idField : "id",
		columns: col,
		pagination:true,
		paginationShowPageGo: true,
	//	fixedColumns: true,        //固定列
		//fixedNumber:3,			  //固定右侧列
	//	fixedRightNumber:5,
		leftFixedColumns:true,
		leftFixedNumber:7,
		rightFixedColumns:true,
		rightFixedNumber:3,

		onClickCell: function (field, value, row, $element) {
			/*console.log("start")
			console.log(field)
			console.log(value)
			console.log(row)
			console.log("$element="+$element)
			console.log($element.parent().data('index'))
			console.log($element.parent().data('emp_name'))
			console.log("end")*/
			let index = $element.parent().data('index');
			//修改单元格
		/*	$element.attr('contenteditable', true);
			$element.blur(function () {
				let index = $element.parent().data('index');
				let tdValue = $element.html();
				//resetAmount(index, field, tdValue)
				// saveData(index, field, tdValue);
			})*/
		if(field=="remarks"){
			remarksmodify(index, field, value,row);
		}else{
			shfitsModify(index, field, value,row);
		}


		},
		/*cellStyle:function(value,row,index){// 修改列（单元格）的颜色


			return {css:{"background-color":"black"}};
		},*/


	};

	//表格
	function initTable(){
		//$('#pageTable').bootstrapTable('destroy');
		$('#pageTable').bootstrapTable('destroy').bootstrapTable(opt);
		$('#pageTable').bootstrapTable('hideColumn', 'id');
	}
	function refreshTable(){
		$("#pageTable").bootstrapTable('destroy').bootstrapTable('refresh', opt);
		$('#pageTable').bootstrapTable('hideColumn', 'id');
	}

	//批量删除
	function delSel(){
		var data = [];
		$("#pageTable input[type='checkbox'][name!='btSelectAll']:checked").each(function(){
			data.push($(this).val());
		});
		if(data.length==0){
			pointLion.alertMsg("请选择要删除的数据!","danger",null,null);
			return;
		}
		console.log(data)
		//del(data.join(","));//执行删除
	}
	//删除
	function del(ids){
		pointLion.confimMsg("您是否要删除所选信息 ?<br/> 点击确认进行删除 , 点击取消取消该操作",null,function(){
			//执行删除
			var data = common_ajax.ajaxFunc("/admin/xd/xdschedulesummary/delete",{"ids":ids}, "json", null);
			//删除结果
			if(data.success){
				pointLion.alertMsg(data.message,"success",null,function(){
					location.href = ctx+'/admin/xd/xdschedulesummary/getListPage';//跳转到列表页
				});
			}else{
				pointLion.alertMsg(data.message,"success",null,null);
			}
		});
	};

	//查询
	function searchTable(){
		let dept = $("#dept").val();
		let emp_name =encodeURIComponent($("#emp_name").val());
		let unitname = $("#unitname").val();
		let year =$("#year").val();
		let month =	$("#month").val();
		var param = {
			query: {
				"dept":dept,
				"emp_name":emp_name,
				"unitname":unitname,
				"year":year,
				"month":month
			}
		}


		var data = common_ajax.ajaxFunc("/admin/xd/xdschedulesummary/getTableHeader",{"year":year,"month":month}, "json", null);
		col =[];
		createTable(data.data.daysNum,data.data.weekLists,data.data.holidayLists);
		opt.columns=col;
				// 刷新表格
		//let bootstrapTable = $('#pageTable').bootstrapTable('refresh',param);
		initTable();
		$(".fixed-table-header-columns>table>thead>tr>th").each(function (i,thobj) {
			$(thobj).css("height",'105px');//设置合并单元格高度
		})
	//	console.log(bootstrapTable)
	}

	$(document).ready(function(){
		$('.form_datetime').datepicker({format: 'yyyy-mm-dd',weekStart: 1,todayBtn:  1,autoclose: 1,language:  'zh-CN',todayHighlight: 1,forceParse: 0,clearBtn: true }).on('changeDate',null);
		initTable();//初始化

		pointLion.initUploader("/admin/xd/xdschedulesummary/importExcel",function(data){
			if(data.success){
				pointLion.alertMsg("导入成功！","success",null,null);
				//searchTable();
				location.href = ctx+'/admin/xd/xdschedulesummary/getListPage';//跳转到列表页
			}else{
				pointLion.alertMsg(data.message,"danger",null,null);
			}
		});
	});
	/***
	 * 导出
	 */

	function exportExcel(){

		let dept = $("#dept").val();
		let emp_name =encodeURIComponent($("#emp_name").val());
		let unitname = $("#unitname").val();
		let year =$("#year").val();
		let month =	$("#month").val();
		if(year==''||month==''){
			pointLion.alertMsg("请选择年月！","success",null,null);
			return;
		}
		location.href = "#(ctx)/admin/xd/xdschedulesummary/exportExcel?dept="+dept+"&emp_name="+emp_name+"&unitname="+unitname+"&year="+year+"&month="+month;
	}
	function exportExcel2(){

		var certTitle = $("#certTitle").val();
		location.href = "#(ctx)/admin/xd/xdschedulesummary/exportExcel2?certTitle="+certTitle;
	}

</script>


<script>
	$(function () {
		let length = $(".fixed-table-header-columns>table>thead>tr>th").length;
		console.log("length="+length);
		$(".fixed-table-header-columns>table>thead>tr>th").each(function (i,thobj) {
			$(thobj).css("height",'105px');//设置合并单元格高度
		})
	/*	$(".fixed-table-container tbody td, .bootstrap-table .table>thead>tr>th").each(function (i,thobj) {
			//$(thobj).css("height",'35px');
			//console.log("-------------")
		})*/

		/*$(".fixed-table-body-columns").css(""paddin"")*/
		$("input[name='btSelectAll']").click(function () {
			/*var btSelectAll = $("input[name='btSelectAll']:checked").val();
			if(btSelectAll=="on"){
			  $("input[name='btSelectItem']").attr('checked','checked');
			}else {
				$("input[name='btSelectItem']").removeAttr('checked');
			}*/

			console.log("click")
			var btSelectAll = $("input[name='btSelectAll']:checked").val();
			console.log(btSelectAll)


			console.log($("input[name='btSelectAll']").prop("checked"))
			if(btSelectAll=="on"){
				$("input[name='btSelectItem']").prop('checked',true);
			}else {
				$("input[name='btSelectItem']").prop('checked',false);
			}
		});
	})
</script>

<script>
	let shifts="#(shifts)";
	let shiftsArr = shifts.split(",");
	let shiftOptions="";
	for (let i = 0; i < shiftsArr.length; i++) {
		shiftOptions=shiftOptions+'<option value="'+shiftsArr[i]+'">'+shiftsArr[i]+'</option>'
	}
	function shfitsModify(index, field, value,row) {
		console.log(field);

		let shiftOptions='';
		for (let i = 0; i < shiftsArr.length; i++) {
			if(value==shiftsArr[i]){
				shiftOptions=shiftOptions+'<option value="'+shiftsArr[i]+'" selected>'+shiftsArr[i]+'</option>'
			}else{
				shiftOptions=shiftOptions+'<option value="'+shiftsArr[i]+'">'+shiftsArr[i]+'</option>'
			}
		}
		let otArr = row.otflas.split(",");
		let fieldNum = field.replace("day","");
		let checkInput='<input id="demo-form-inline-checkbox" class="magic-checkbox" type="checkbox" name="ovtime" >';
		if(otArr[parseInt(fieldNum)]=='1'){
			checkInput='<input id="demo-form-inline-checkbox" class="magic-checkbox" type="checkbox" name="ovtime" checked="checked">';
		}
		//console.log(checkInput)
		//'<input id="demo-form-inline-checkbox" class="magic-checkbox" type="checkbox" name="ovtime" checked="">'+

		//let  fValue="";
		bootbox.dialog({
			title: "班次调整",
			message:'<div class="row"> ' +
					'<div class="col-md-12"> ' +
					'<form class="form-horizontal"> ' +
					'<div class="form-group"> ' +
					'<label class="col-md-4 control-label" for="name">姓名</label> ' +
					'<div class="col-md-4"> ' +
					'<input id="name" name="name" type="text" value="'+row.emp_name+'"  class="form-control input-md"> ' +
					'</div> ' +
					'</div> ' +
					'<div class="form-group"> ' +
					'<label class="col-md-4 control-label" for="shift">班次</label> ' +
					'<div class="col-md-4"> ' +
					'<select class="form-control "  id="shift"   data-live-search="true"  >'+
					'<option value="">------班次------</option>'+
					shiftOptions+
					'</select>'+
					'</div> ' +
					'</div> ' +
					'<div class="form-group"> ' +
					'<label class="col-md-4 control-label" for="awesomeness">是否加班</label> ' +
					'<div class="col-md-8">' +
					'<div class="checkbox">'+
					//'<input id="demo-form-inline-checkbox" class="magic-checkbox" type="checkbox" name="ovtime" checked="">'+
					checkInput+
					'<label for="demo-form-inline-checkbox"></label>'+
					'</div>'+
					'</div> ' +
					'</div>' +
					'<\/form><\/div><\/div><\/script><\/script>',
			buttons: {
				success: {
					label: "Save",
					className: "btn-purple",
					callback: function() {
						var shift = $('#shift').val();
						var overtime = $("input[name='ovtime']:checked").val();
						//fValue="<span color='red'>"+shift+"</span>";
						$('#pageTable').bootstrapTable('updateCell', {
							index: index,
							field: field,
							value: shift
						})
						let data = common_ajax.ajaxFunc("/admin/xd/xdschedulesummary/updateCell",{"id":row.id,"oldValue":value,"modValue":shift,"overtime":overtime,"field":field,"type":"1"}, "json", null);
						console.log("-----"+data.message)
						$('#pageTable').bootstrapTable('updateCell', {
							index: index,
							field: "othours",
							value: data.message
						})
					},


		/*var upIndex = $element.data('index');
        row.field=$("#editId").val();
        $('#cancelBillListTable').bootstrapTable('updateRow', {
            index: upIndex,
            row: row
        });*/

				}
			}
		});
	}

	function remarksmodify(index, field, value,row) {
		bootbox.dialog({
			title: "备注调整",
			message:'<div class="row"> ' +
					'<div class="col-md-12"> ' +
					'<form class="form-horizontal"> ' +
					'<div class="form-group"> ' +
					'<label class="col-md-4 control-label" for="name">姓名</label> ' +
					'<div class="col-md-6"> ' +
					'<input id="name" name="name" type="text" value="'+row.emp_name+'" placeholder="Your name" readonly="readonly" class="form-control input-md"> ' +
					'</div> ' +
					'</div> ' +
					'<div class="form-group"> ' +
					'<label class="col-md-4 control-label" for="">备注</label> ' +
					'<div class="col-md-6"> ' +
					'<textarea id="remarks" placeholder="Message" rows="5" class="form-control">'+value+'</textarea>'+
					'</div> ' +
					'</div> ' +
					'<\/form><\/div><\/div><\/script><\/script>',
			buttons: {
				success: {
					label: "Save",
					className: "btn-purple",
					callback: function() {
						var remarks = $('#remarks').val();
						console.log(remarks)
						$('#pageTable').bootstrapTable('updateCell', {
							index: index,
							field: field,
							value: remarks
						})
						common_ajax.ajaxFunc("/admin/xd/xdschedulesummary/updateCell",{"id":row.id,"oldValue":value,"modValue":remarks,"overtime":"","field":field,"type":"2"}, "json", null);
					},
				}
			}
		});
	}
</script>
