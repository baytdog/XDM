<link href="#(ctx)/common/plugins/jquery-ui/scripts/miniui/themes/default/miniui.css" rel="stylesheet"/>
<div id="page-content">
	<div class="col-lg-12">
		<div class="panel">
			#include("editForm.html")
		</div>
	</div>
</div>


<script>
	function save(){

		let data = common_ajax.ajaxFunc("/admin/xd/xdempcert/save",$('#editForm').serialize(), "json", null);
		if(data.success){
			pointLion.alertMsg("操作成功!" , "success" , "small" , function(){
				location.href = ctx+'/admin/xd/xdempcert/getListPage';//跳转到列表页
			},data);
		}else{
			pointLion.alertMsg(data.message , "danger" , "small" , function(){
				$(".btn").removeAttr("disabled");
			},data);
		}
	}
	$(document).ready(function() {
		$('#editForm').bootstrapValidator({
			fields: {
			}
		}).on("success.form.bv", function (e) {
			save();
			return false;//阻止表单跳转
		});
	});
</script>

<script>

	function chooseEmployees(){
		pointLion.selectManyUser1("orgid="+encodeURIComponent("root"),$("#eid").val(),function(data){
			$("#eid").val(data.idData);
			$("#ename").val(data.nameData);
		});
	}

	function resetVali(){
		if(!$("#editForm").data('bootstrapValidator').isValid()) {
			$("#editForm").data('bootstrapValidator').resetForm();
			$(".btn").removeAttr("disabled");
		}
	}
	$(function(){

		$('.form_datetime').datepicker({format: 'yyyy-mm-dd',weekStart: 1,todayBtn:  1,autoclose: 1,language:  'zh-CN',todayHighlight: 1,forceParse: 0,showMeridian: 1}).on('changeDate',function(){
			let startTime = $("#startTime").val();
			let endTime = $("#endTime").val();
			/*if(startTime&&endTime){
				if(!dateUtil.compareCalendar(startTime,endTime)){
				}else{

				}
			}*/
			resetVali();
		});


		$(".selectpicker").selectpicker({});
		$(".bootstrap-select").attr("style","width:100%;");

		// 下拉框处理 start

		let department=$("#department").val();
		if(department){
			$('#departmentSelect').selectpicker('val',department.split(",")).trigger("change");
		}

		$('#departmentSelect').on('changed.bs.select', function (e) {
			$('#department').val($('#departmentSelect').val())
		});

		let certId=$("#certId").val();
		if(certId){
			$('#certIdSelect').selectpicker('val',certId.split(",")).trigger("change");
		}

		$('#certIdSelect').on('changed.bs.select', function (e) {
			$('#certId').val($('#certIdSelect').val())
			$('#certTile').val($('#certIdSelect option:selected').text())

		});

		let certAuthValue=$("#certAuthValue").val();
		if(certAuthValue){
			$('#certAuthSelect').selectpicker('val',certAuthValue.split(",")).trigger("change");
		}

		$('#certAuthSelect').on('changed.bs.select', function (e) {
			$('#certAuthValue').val($('#certAuthSelect').val())
			$('#certAuthName').val($('#certAuthSelect option:selected').text())
		});


		let certLevel=$("#certLevel").val();
		if(certLevel){
			$('#certLevelSelect').selectpicker('val',certLevel.split(",")).trigger("change");
		}

		$('#certLevelSelect').on('changed.bs.select', function (e) {
			$('#certLevel').val($('#certLevelSelect').val())
		});





		let certstatus=$("#certstatus").val();
		if(certstatus){
			$('#certstatusSelect').selectpicker('val',certstatus.split(",")).trigger("change");
		}

		$('#certstatusSelect').on('changed.bs.select', function (e) {
			$('#certstatus').val($('#certstatusSelect').val())
		});
	})
</script>



